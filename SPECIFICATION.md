# ゆにぱけスキャナー (unitypackage-scanner) 仕様書

## 1. プロジェクト概要

### 1.1 プロジェクト名
- **日本語名**: ゆにぱけスキャナー
- **英語名**: unitypackage-scanner
- **略称**: upkg-scanner

### 1.2 目的
UnityPackage（.unitypackage）ファイルの内容を複数のAIサービスを用いて分析・検証するデスクトップアプリケーション

**ビジネスモデル**:
- 完全無償で公開（オープンソース想定）
- ユーザーが自身のAPIキーを使用
- 開発者側でのAPI費用負担なし

### 1.2 対象ユーザー
- Unity開発者
- パッケージの安全性を確認したい開発者
- 第三者製UnityPackageを使用前にチェックしたい開発者

### 1.3 技術スタック
- **フロントエンド**: Electron + TypeScript + React
- **パッケージング**: Electron Builder
- **AI統合**: Claude API, OpenAI API, Google Gemini API

## 2. 機能要件

### 2.1 コア機能

#### 2.1.1 AIプロバイダー選択
- **Phase 1でサポート**: Claude (Anthropic)
- **将来的にサポート予定**:
    - ChatGPT (OpenAI)
    - Gemini (Google)
    - その他のプロバイダー（プラグイン形式で拡張可能に）
- ドロップダウンまたはラジオボタンで選択
- 選択状態の保存（ローカルストレージ）
- **重要**: ユーザーが各自のAPIキーを設定・使用

#### 2.1.2 UnityPackageファイル読み込み
- ドラッグ&ドロップ対応
- ファイルブラウザからの選択
- 対応形式: `.unitypackage`
- ファイルサイズ制限: 100MB（設定で変更可能）

#### 2.1.3 パッケージ解析
- .unitypackage（tar.gz形式）の解凍
- 含まれるファイル一覧の抽出
- メタデータの解析:
    - スクリプトファイル（.cs）
    - アセットファイル（.prefab, .asset, .mat等）
    - 依存関係情報

#### 2.1.4 AI分析
- 抽出した情報をAIに送信
- 分析項目:
    - セキュリティリスクの検出
    - 悪意のあるコードの有無
    - 依存関係の問題
    - ベストプラクティス違反
    - パフォーマンス上の懸念

#### 2.1.5 結果表示
- 分析結果のカテゴリ別表示:
    - 重大度（Critical, Warning, Info）
    - カテゴリ（Security, Performance, Best Practice）
- 詳細ビュー:
    - 該当ファイルのパス
    - 問題の説明
    - 推奨される対処法
- エクスポート機能:
    - JSON形式
    - Markdown形式
    - PDF形式（オプション）

### 2.2 設定機能

#### 2.2.1 API設定
- 各AIプロバイダーの認証方式に対応
    - **認証方式はプロバイダーごとに異なる**:
        - OAuth 2.0フロー（ブラウザリダイレクト）
        - APIキー手動入力
        - その他プロバイダー固有の認証方式
    - 「連携する」ボタンでプロバイダーに応じた認証フローを開始
    - 各プロバイダーの認証方法の説明・ヘルプリンクを表示
    - **特定のプロバイダーを推奨しない**（選択はユーザー判断）
- 取得したトークン/APIキーの暗号化保存（electron-store + encryption）
- 接続テスト機能
- 認証未完了時の案内表示

#### 2.2.2 分析オプション
- 分析の深さ（Quick / Standard / Deep）
- 特定ファイルタイプの除外
- カスタムプロンプトの設定（上級者向け）

#### 2.2.3 アプリケーション設定
- テーマ（Light / Dark）
- 言語（日本語 / English）
- ログレベル設定

## 3. 非機能要件

### 3.1 パフォーマンス
- パッケージ解析: 10MB以下のファイルで5秒以内
- UI応答性: 操作後100ms以内にフィードバック
- API呼び出し: タイムアウト60秒

### 3.2 セキュリティ
- APIキーの安全な保存（electron-store + 暗号化）
- 解析中のファイルは一時ディレクトリに展開、終了後削除
- 通信はすべてHTTPS

### 3.3 互換性
- 対応OS: Windows 10+, macOS 11+, Linux (Ubuntu 20.04+)
- Electron: 最新LTS版
- Node.js: 18.x以上

### 3.4 ユーザビリティ
- 初回起動時のセットアップウィザード
- エラーメッセージの多言語対応
- 処理中のプログレスバー表示

## 4. アーキテクチャ

### 4.1 ディレクトリ構成
```
unitypackage-scanner/
├── src/
│   ├── main/                 # Electronメインプロセス
│   │   ├── index.ts
│   │   ├── ipc/             # IPC通信ハンドラ
│   │   ├── auth/            # 認証フロー管理
│   │   │   ├── authManager.ts      # 認証の抽象化レイヤー
│   │   │   ├── strategies/         # 認証戦略パターン
│   │   │   │   ├── base.ts         # 基底クラス
│   │   │   │   ├── oauth.ts        # OAuthフロー
│   │   │   │   ├── apiKey.ts       # APIキー入力
│   │   │   │   └── custom.ts       # カスタム認証
│   │   │   └── providers/
│   │   │       ├── claude.ts       # Claude固有の認証実装
│   │   │       ├── openai.ts       # OpenAI固有の認証実装
│   │   │       └── gemini.ts       # Gemini固有の認証実装
│   │   └── services/
│   │       ├── packageParser.ts
│   │       └── aiProviders/
│   │           ├── base.ts
│   │           ├── claude.ts
│   │           ├── openai.ts
│   │           └── gemini.ts
│   ├── renderer/             # Reactフロントエンド
│   │   ├── App.tsx
│   │   ├── components/
│   │   │   ├── ProviderSelector.tsx
│   │   │   ├── FileUploader.tsx
│   │   │   ├── AnalysisResult.tsx
│   │   │   ├── Settings.tsx
│   │   │   └── AuthFlow/       # 認証UI（プロバイダー別）
│   │   │       ├── OAuthAuth.tsx
│   │   │       ├── ApiKeyAuth.tsx
│   │   │       └── HybridAuth.tsx
│   │   ├── hooks/
│   │   └── utils/
│   └── shared/              # 共通型定義
│       └── types.ts
├── package.json
├── tsconfig.json
└── electron-builder.json
```

### 4.2 データフロー

#### 認証フロー（Strategy パターン）
各プロバイダーは認証戦略を選択:

**パターン1: OAuth 2.0フロー**
1. ユーザーが「連携する」ボタンをクリック
2. メインプロセスでローカルサーバー起動（コールバック受信用）
3. デフォルトブラウザでプロバイダーの認証URLを開く
4. ユーザーがブラウザで認証・承認
5. プロバイダーがコールバックURL（localhost）にリダイレクト
6. ローカルサーバーがトークンを受け取り
7. トークンを暗号化して保存
8. レンダラープロセスに認証完了を通知
9. ローカルサーバー停止

**パターン2: APIキー手動入力**
1. ユーザーがAPIキーを入力
2. 「接続テスト」ボタンでバリデーション
3. 成功したらAPIキーを暗号化して保存
4. レンダラープロセスに認証完了を通知

**パターン3: カスタム認証**
- プロバイダー固有の認証フローを実装
- 基底クラスを継承してカスタム処理を追加

#### プロバイダー追加時の拡張性
```typescript
// 新しいプロバイダーを追加する場合
class NewProviderAuth extends BaseAuthStrategy {
  async authenticate(): Promise<AuthResult> {
    // プロバイダー固有の認証処理
  }
  
  getAuthType(): 'oauth' | 'apikey' | 'custom' {
    return 'custom';
  }
}
```

#### スキャンフロー
1. ユーザーがファイルをドロップ
2. メインプロセスでパッケージ解析
3. 選択されたAIプロバイダーに分析リクエスト（保存済み認証情報使用）
4. レンダラープロセスに結果を返却
5. UIに結果を表示

### 4.3 状態管理
- React Context API または Zustand
- 設定: electron-store
- 分析結果: メモリ内（セッション単位）

## 5. UI/UX設計

### 5.0 初回起動フロー

#### 5.0.1 注意事項ダイアログ（初回必須表示）
```
┌─────────────────────────────────────────┐
│ ゆにぱけスキャナー - ご利用にあたって    │
├─────────────────────────────────────────┤
│                                         │
│ 【重要な注意事項】                      │
│                                         │
│ ✓ このアプリはAI APIを利用します        │
│ ✓ APIキーは各自で取得・管理してください │
│ ✓ API使用料金はユーザー様負担です       │
│ ✓ 分析結果はAIによるものであり、        │
│   完全性を保証するものではありません    │
│                                         │
│ 【製作者情報】                          │
│ サークル名: 朔日工房                    │
│ 製作者: 鴇峰朔華                        │
│                                         │
│ ※本ツールの分析結果について、製作者は  │
│   一切の責任を負いません                │
│                                         │
│ ご利用前に必ず [利用規約] をお読みください│
│                                         │
│ □ 利用規約に同意する（必須）            │
│ □ 次回から表示しない                    │
│                                         │
│              [同意して続ける]           │
└─────────────────────────────────────────┘
```
※「利用規約に同意する」にチェックが入っていない場合、
「同意して続ける」ボタンは無効化

#### 5.0.2 セットアップウィザード（認証未完了時）

**パターンA: OAuth対応プロバイダー（例: OpenAI）**
```
Step 2/3: API連携
┌─────────────────────────────────────────┐
│ OpenAI APIと連携                        │
├─────────────────────────────────────────┤
│                                         │
│ 💡 ブラウザでOpenAIの認証画面が開きます │
│                                         │
│ 1. OpenAIアカウントでログイン           │
│ 2. API利用を承認                        │
│ 3. 自動的にアプリに戻ります             │
│                                         │
│            [ブラウザで連携する]         │
│                                         │
│                    [戻る]    [次へ]     │
└─────────────────────────────────────────┘
```

**パターンB: APIキー入力プロバイダー（例: Claude）**
```
Step 2/3: API連携
┌─────────────────────────────────────────┐
│ Claude APIと連携                        │
├─────────────────────────────────────────┤
│                                         │
│ APIキー:                                │
│ [sk-ant-********************************]│
│                                         │
│ 💡 APIキーの取得方法:                   │
│ 1. console.anthropic.com にアクセス     │
│ 2. API Keys > Create Key               │
│ 3. 生成されたキーをコピー               │
│                                         │
│ [APIキー取得方法を見る]                 │
│                                         │
│              [接続テスト]               │
│                                         │
│                    [戻る]    [次へ]     │
└─────────────────────────────────────────┘
```

**パターンC: ハイブリッド（OAuth + 手動入力両対応）**
```
Step 2/3: API連携
┌─────────────────────────────────────────┐
│ Google Gemini APIと連携                 │
├─────────────────────────────────────────┤
│                                         │
│ 💡 推奨: ブラウザで簡単に連携           │
│                                         │
│            [ブラウザで連携する]         │
│                                         │
│ ─────────── または ───────────          │
│                                         │
│ APIキーを手動で入力:                    │
│ [********************************]      │
│ [APIキー取得方法を見る]                 │
│                                         │
│              [接続テスト]               │
│                                         │
│                    [戻る]    [次へ]     │
└─────────────────────────────────────────┘
```

**共通: 連携中画面（OAuth使用時）**
```
Step 2/3: 連携中...
┌─────────────────────────────────────────┐
│ [Provider名] APIと連携中                │
├─────────────────────────────────────────┤
│                                         │
│          ⏳ 認証を待っています...       │
│                                         │
│ ブラウザで認証を完了してください        │
│                                         │
│ ブラウザが開かない場合:                 │
│ [認証URLを表示]                         │
│                                         │
│              [キャンセル]               │
│                                         │
└─────────────────────────────────────────┘
```

Step 3/3: 完了
┌─────────────────────────────────────────┐
│ セットアップ完了！                      │
├─────────────────────────────────────────┤
│                                         │
│ ✓ [Provider名] APIと連携しました        │
│                                         │
│ これで.unitypackageファイルを            │
│ スキャンできます                        │
│                                         │
│ 使い方:                                 │
│ • ウィンドウにファイルをドロップ        │
│ • またはショートカットにドロップ        │
│                                         │
│                           [始める]      │
└─────────────────────────────────────────┘
```

### 5.1 メイン画面（APIキー設定済み）
```
┌─────────────────────────────────────────┐
│ ゆにぱけスキャナー            [_][□][X]│
├─────────────────────────────────────────┤
│ 🤖 Claude      [変更]         [⚙設定]  │
├─────────────────────────────────────────┤
│                                         │
│   ┌───────────────────────────────┐   │
│   │         📦                    │   │
│   │                               │   │
│   │  .unitypackageファイルを      │   │
│   │    ここにドロップ             │   │
│   │                               │   │
│   │  またはクリックして選択       │   │
│   └───────────────────────────────┘   │
│                                         │
│   💡 Tip: アプリのショートカットに      │
│      ドロップしても起動できます         │
│                                         │
└─────────────────────────────────────────┘
```

### 5.2 スキャン中の画面
```
┌─────────────────────────────────────────┐
│ ゆにぱけスキャナー            [_][□][X]│
├─────────────────────────────────────────┤
│ 🤖 Claude      [変更]         [⚙設定]  │
├─────────────────────────────────────────┤
│                                         │
│  📦 MyAwesomePackage.unitypackage       │
│                                         │
│  スキャン中...                          │
│  ▓▓▓▓▓▓▓▓▓▓▓░░░░░  65%                │
│                                         │
│  ✓ パッケージを展開しました             │
│  ✓ ファイルを分析中... (23/45)         │
│  ⏳ AIによる検証中...                   │
│                                         │
│              [キャンセル]               │
│                                         │
└─────────────────────────────────────────┘
```

### 5.3 結果表示画面（シンプル表示）
```
┌─────────────────────────────────────────┐
│ ゆにぱけスキャナー            [_][□][X]│
├─────────────────────────────────────────┤
│ 🤖 Claude      [変更]         [⚙設定]  │
├─────────────────────────────────────────┤
│                                         │
│  📦 MyAwesomePackage.unitypackage       │
│                                         │
│  ┌─────────────────────────────────┐  │
│  │                                 │  │
│  │         ⚠️  注意が必要          │  │
│  │                                 │  │
│  │   いくつかの問題が検出されました │  │
│  │                                 │  │
│  └─────────────────────────────────┘  │
│                                         │
│  または                                 │
│                                         │
│  ┌─────────────────────────────────┐  │
│  │                                 │  │
│  │         ✅  問題なし            │  │
│  │                                 │  │
│  │   重大な問題は検出されませんでした│  │
│  │                                 │  │
│  └─────────────────────────────────┘  │
│                                         │
│            [詳細を見る]                 │
│            [新しくスキャン]             │
│                                         │
└─────────────────────────────────────────┘
```

### 5.4 詳細結果画面
```
┌─────────────────────────────────────────────────┐
│ スキャン結果 - MyAwesomePackage    [×]          │
├─────────────────────────────────────────────────┤
│ 【免責事項】                                    │
│ この分析結果はAI(Claude)によるものです。        │
│ 製作者（朔日工房/鴇峰朔華）は分析結果の         │
│ 正確性・完全性について一切の責任を負いません。  │
├─────────────────────────────────────────────────┤
│                                                 │
│ 📊 スキャン概要                                 │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━              │
│ スキャン日時: 2025/10/07 14:32                 │
│ AIプロバイダー: Claude Sonnet 4.5              │
│ ファイル数: 45個                                │
│ パッケージサイズ: 12.3 MB                       │
│                                                 │
│ 🔍 検出された問題                               │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━              │
│                                                 │
│ ⛔ Critical (0)                                 │
│                                                 │
│ ⚠️  Warning (3)                                 │
│ ┌───────────────────────────────────────────┐ │
│ │ ⚠️  古いUnity APIの使用                    │ │
│ │ 📄 Scripts/PlayerController.cs            │ │
│ │ 💬 WWWクラスが使用されています。            │ │
│ │    UnityWebRequestへの移行を推奨します。   │ │
│ └───────────────────────────────────────────┘ │
│                                                 │
│ ┌───────────────────────────────────────────┐ │
│ │ ⚠️  パフォーマンスの懸念                   │ │
│ │ 📄 Scripts/EnemySpawner.cs                │ │
│ │ 💬 Update内でGameObject.Findが使用されて   │ │
│ │    います。キャッシュの使用を検討して      │ │
│ │    ください。                              │ │
│ └───────────────────────────────────────────┘ │
│                                                 │
│ ℹ️  Info (5)                                    │
│ [すべて表示]                                    │
│                                                 │
│ ✅ 問題なし                                     │
│ • セキュリティリスク: 検出されませんでした      │
│ • 外部通信: 検出されませんでした                │
│ • 悪意のあるコード: 検出されませんでした        │
│                                                 │
│         [エクスポート]  [閉じる]                │
└─────────────────────────────────────────────────┘
```

### 5.5 設定画面
```
┌─────────────────────────────────────────┐
│ 設定                          [×]        │
├─────────────────────────────────────────┤
│                                         │
│ 【AIプロバイダー】                      │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━            │
│                                         │
│ ◉ Claude (連携済み)                    │
│   アカウント: user@example.com         │
│   [再連携] [連携解除]                  │
│                                         │
│ ○ OpenAI (未連携)                      │
│   [連携する]                           │
│                                         │
│ ○ Google Gemini (未連携)               │
│   [連携する]                           │
│                                         │
│ 【分析オプション】                      │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━            │
│                                         │
│ 分析の深さ:                             │
│ ◉ 標準  ○ 簡易  ○ 詳細                │
│                                         │
│ 最大ファイルサイズ:                     │
│ [100] MB                                │
│                                         │
│ 【アプリケーション】                    │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━            │
│                                         │
│ テーマ: ◉ ライト  ○ ダーク             │
│ 言語:   [日本語 ▼]                     │
│                                         │
│ □ 起動時に注意事項を表示する            │
│                                         │
│ 【情報】                                │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━            │
│                                         │
│ バージョン: 1.0.0                       │
│ 製作: 朔日工房 / 鴇峰朔華               │
│ [利用規約] [ライセンス] [GitHub]       │
│                                         │
│              [保存]  [キャンセル]       │
└─────────────────────────────────────────┘
```

### 5.6 操作フロー

#### 5.6.1 初回起動時
1. 注意事項ダイアログ表示（必須）
2. 「次回から表示しない」チェック可能
3. 「同意して続ける」でウィザード開始
4. AIプロバイダー選択
5. APIキー設定
6. 接続テスト
7. 完了→メイン画面

#### 5.6.2 通常利用（2回目以降）
1. メイン画面表示
2. ファイルドロップ（ウィンドウまたはショートカット）
3. スキャン実行
4. シンプル結果表示（✅/⚠️）
5. 必要に応じて「詳細を見る」

#### 5.6.3 ショートカットからの起動
- .unitypackageをショートカットにドロップ
- アプリ起動＋即スキャン開始
- 結果表示後、新しくスキャンまたは終了

### 5.7 デザインガイドライン

**カラーパレット:**
- プライマリ: #4A90E2 (青)
- 成功: #5CB85C (緑)
- 警告: #F0AD4E (オレンジ)
- エラー: #D9534F (赤)
- 背景: #FFFFFF / #F8F9FA

**フォント:**
- 日本語: Noto Sans JP
- 英数字: Inter

**アイコン:**
- Material Icons または Lucide React

**アニメーション:**
- スキャン中: スムーズなプログレスバー
- 結果表示: フェードイン
- 画面遷移: 200ms ease-in-out

## 6. 開発フェーズ

### 段階的実装の方針

本プロジェクトは段階的な実装により、早期からの動作確認とフィードバック取得を重視します。

#### 実装の優先順位
1. **UIモックから開始**: まず見た目を完成させ、段階的に機能を実装
2. **コア機能の実装優先**: UIの洗練より機能の動作を優先
3. **単一プロバイダーでの完成**: まずClaude対応を完全に仕上げる
4. **拡張性の確保**: アーキテクチャは将来の拡張を見据えて設計

#### 実装アプローチ
**モックファースト開発**:
1. 完全なUIモックを作成（ダミーデータ使用）
2. ユーザーフローを確認・調整
3. 段階的に実際の機能を実装していく

このアプローチにより:
- UI/UXの早期確認が可能
- 実装の方向性が明確になる
- 段階的な機能追加がしやすい

#### Phase 1: UIモック作成
**目標**: 全画面のUIモックを完成させる（機能は未実装）

- [ ] プロジェクトセットアップ
  - [ ] Electron + React + TypeScript環境構築
  - [ ] 基本的なディレクトリ構成
  - [ ] ビルド・開発環境整備
  
- [ ] UIコンポーネント作成（全てモック）
  - [ ] 注意事項ダイアログ
  - [ ] セットアップウィザード（3ステップ）
  - [ ] メイン画面
  - [ ] スキャン中画面
  - [ ] 結果表示画面（シンプル表示）
  - [ ] 詳細結果画面
  - [ ] 設定画面
  
- [ ] ダミーデータの準備
  - [ ] サンプル分析結果データ
  - [ ] 各種状態のモックデータ
  
- [ ] 画面遷移の実装
  - [ ] ルーティング設定
  - [ ] 画面間の遷移確認
  - [ ] 状態管理の基本構造

**Phase 1完了の定義**:
- 全画面が表示される
- 画面遷移が動作する
- ボタンクリックで画面が切り替わる（機能は動作しなくてOK）
- デザインが確認できる

#### Phase 2: 認証機能の実装
**目標**: Claude APIキー手動入力を実装

- [ ] APIキー管理機能
  - [ ] APIキー入力UI（モックを実装に置き換え）
  - [ ] electron-storeによる暗号化保存
  - [ ] 保存されたAPIキーの読み込み
  
- [ ] Claude API接続
  - [ ] APIキーの検証（接続テスト）
  - [ ] エラーハンドリング
  - [ ] 接続状態の表示
  
- [ ] セットアップフロー
  - [ ] 初回起動検知
  - [ ] 注意事項ダイアログの制御
  - [ ] ウィザード完了状態の保存

**Phase 2完了の定義**:
- APIキーを設定できる
- 接続テストが動作する
- 設定したAPIキーが保存・読み込みされる
- セットアップウィザードが一通り動作する

#### Phase 3: スキャン機能の実装（解析部分）
**目標**: UnityPackageファイルの解析機能を実装

- [ ] ファイル処理
  - [ ] ドラッグ&ドロップの実装
  - [ ] .unitypackageファイルの読み込み
  - [ ] tar.gzの展開処理
  
- [ ] パッケージ解析
  - [ ] ファイル構造の解析
  - [ ] メタデータの抽出
  - [ ] スクリプトファイル（.cs）の抽出
  - [ ] アセット情報の取得
  
- [ ] 解析結果の整理
  - [ ] データ構造の設計
  - [ ] 解析情報の整形

**Phase 3完了の定義**:
- .unitypackageファイルをドロップできる
- ファイルが展開される
- 中身のファイル一覧が取得できる
- コンソールで解析結果が確認できる

#### Phase 4: AI分析機能の実装
**目標**: Claude APIで実際の分析を実行

- [ ] Claude API連携
  - [ ] プロンプト設計
  - [ ] 解析データのプロンプト化
  - [ ] API呼び出し実装
  - [ ] レスポンスのパース
  
- [ ] 分析実行フロー
  - [ ] スキャン開始処理
  - [ ] 進行状況の表示（実装）
  - [ ] エラーハンドリング
  - [ ] キャンセル機能
  
- [ ] 結果表示
  - [ ] AIレスポンスの解析
  - [ ] 結果データへの変換
  - [ ] シンプル表示（✅/⚠️）の実装
  - [ ] 詳細表示の実装

**Phase 4完了の定義**:
- ファイルをドロップしてスキャンが実行される
- Claude APIで分析が行われる
- 結果が画面に表示される
- 実際に使える状態

#### Phase 5: 機能の完成とドキュメント
**目標**: Phase 1-4で作ったものを完成させる

- [ ] ショートカット対応
  - [ ] ショートカットへのドラッグ&ドロップ
  - [ ] コマンドライン引数でのファイル起動
  
- [ ] エクスポート機能
  - [ ] JSON形式でのエクスポート
  - [ ] Markdown形式でのエクスポート
  
- [ ] UI/UX改善
  - [ ] アニメーション追加
  - [ ] エラーメッセージの改善
  - [ ] ローディング表示の改善
  
- [ ] ドキュメント整備
  - [ ] README完成版
  - [ ] 利用規約完成版
  - [ ] ライセンス情報
  - [ ] APIキー取得ガイド

**Phase 5完了の定義**:
- 全ての基本機能が動作する
- ドキュメントが揃っている
- 他人に配布できる品質

#### Phase 6: 他プロバイダー対応
**目標**: OpenAI、Gemini対応

- [ ] 認証システムの拡張
  - [ ] Strategy パターンでの認証基盤構築
  - [ ] OAuth対応の実装
  - [ ] 複数プロバイダーの管理
  
- [ ] OpenAI対応
  - [ ] 認証実装
  - [ ] API連携
  - [ ] プロンプト最適化
  
- [ ] Gemini対応
  - [ ] 認証実装
  - [ ] API連携
  - [ ] プロンプト最適化
  
- [ ] プロバイダー管理UI
  - [ ] 複数プロバイダーの切り替え
  - [ ] プロバイダー別設定

**Phase 6完了の定義**:
- 3つのAIプロバイダーが選択可能
- それぞれで正常に分析できる

#### Phase 7: 高度な機能
**目標**: 実用性と利便性の向上

- [ ] バッチ処理
  - [ ] 複数ファイルの一括スキャン
  - [ ] 結果の一括エクスポート
  
- [ ] 履歴機能
  - [ ] スキャン履歴の保存
  - [ ] 過去結果の再表示
  
- [ ] カスタマイズ
  - [ ] カスタムルールの追加
  - [ ] プロンプトテンプレートのカスタマイズ
  
- [ ] 多言語対応
  - [ ] 英語UI
  - [ ] その他言語

- [ ] CLI版
  - [ ] コマンドラインツール
  - [ ] CI/CD統合

**Phase 7完了の定義**:
- 実用的な追加機能が揃っている
- コミュニティからのフィードバックを反映

### 実装時の注意事項

#### モックファースト開発のメリット
- UIの完成イメージが明確になる
- 実装前にユーザーフローを確認できる
- 段階的な実装がしやすい
- 各Phaseの成果が目に見える

#### コードの品質
- Phase 1はUIのみに集中（バックエンドは後回し）
- Phase 2-4で段階的に機能を実装
- リファクタリングは各Phase完了後
- テストは重要な部分から段階的に追加

#### ドキュメント
- コード内コメントは最小限
- 重要な設計判断はコミットメッセージに記録
- ユーザー向けドキュメントは早めに整備

#### リリース戦略
- Phase 1-3完了時: UIと解析のみ動作確認
- Phase 4完了時: 個人利用・内部テスト
- Phase 5完了時: アルファ版としてクローズドテスト
- Phase 6完了時: ベータ版として限定公開
- Phase 7完了時: 正式版としてオープンソース公開

## 7. リスクと対策

| リスク | 影響 | 対策 |
|--------|------|------|
| ユーザーのAPI料金負担 | 中 | 事前に推定コスト表示、分析サイズ制限 |
| APIキーの誤入力 | 低 | 接続テスト機能、エラーメッセージ改善 |
| 大容量ファイルの処理 | 中 | ストリーミング処理、チャンク分割 |
| AIの分析精度 | 中 | 将来的に複数AIの結果比較機能 |
| APIキーの漏洩 | 高 | 暗号化、セキュアストレージ、注意喚起 |

## 8. ユーザーへの注意事項

アプリ内に以下を明記:
- **APIキーは各自で取得・管理が必要**
- **API使用料金はユーザー負担**
- **プロバイダーの選択はユーザー判断**（製作者は推奨しない）
- **APIキーの取り扱いに関する注意**
- **分析結果の正確性について製作者は責任を負わない**
- **オープンソースプロジェクトであることの明示**

## 9. 今後の拡張可能性
- バッチ処理（複数ファイル一括分析）
- CLI版の提供
- CI/CD統合
- カスタムルールの追加
- プラグインシステム（ユーザー独自のAIプロバイダー追加）
- コミュニティ共有機能（分析結果の匿名共有）
- ローカルLLMのサポート（API費用ゼロ）